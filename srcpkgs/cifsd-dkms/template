# Template file for 'cifsd-dkms'
pkgname=cifsd-dkms
_pkgname="${pkgname/-dkms}"
version=3.2.5
revision=1
wrksrc="${_pkgname}-${version}"
short_desc="Opensource In-kernel CIFS/SMB3 server"
maintainer="Christopher Brannon <chris@the-brannons.com>"
license="GPL-2.0-only"
homepage="https://github.com/cifsd-team/cifsd"
distfiles="https://github.com/cifsd-team/${_pkgname}/archive/${version}.tar.gz"
checksum=b93a068f6dc2b2040c8cebcb67f6d8c3a1c5c7c5032269a48579ccba996e6be7

dkms_modules="cifsd ${version}"
depends="dkms"

do_install() {
	vmkdir "usr/src/${_pkgname}-${version}"
	cp -r * "$DESTDIR/usr/src/${_pkgname}-${version}"
	vcopy "${FILESDIR}/dkms.conf" "usr/src/${_pkgname}-${version}"
	vsed -e "s;@MAKEJOBS@;${makejobs};" \
		-e "s;@VERSION@;${version}-${revision};" \
		-i "${DESTDIR}/usr/src/${_pkgname}-${version}/dkms.conf"
}
